{% extends "layout.html" %}

{% block content %}
    <form method="POST" x-data="{ subsidiary: '{{subsidiaries.first}}' }">
        {% csrf_token %}
        <label for="date">Date:</label>
        <input type="date" id="date" name="date" value="{{today|date:"Y-m-d"}}" required>
        <label for="subsidiary">Subsidiary:</label>
        <select x-model= "subsidiary" id="subsidiary" name="subsidiary" required>
            {% for subsidiary in subsidiaries %}
                {% if forloop.first %}
                    <option value="{{ subsidiary.name }}" selected>{{ subsidiary.name }}</option>
                {% else %}
                <option value="{{ subsidiary.name }}">{{ subsidiary.name }}</option>
                {% endif %}
            {% endfor %}
        </select>

        <h1>Ventas</h1>
        <div class="grid">
            <p>Producto - Categoría</p>
            <p>Cantidad</p>
            <p>Precio</p>
            <p>Monto</p>
        </div>
        {% for product in products %}
            <div x-data="{price:{{product.price}},quantity:0}" class="grid" x-show="subsidiary == '{{product.subsidiary}}'" >
                <p>
                    {{ product.name }} - {{ product.category.name }}
                </p>
                <input type="number" name="quantity-{{product.id}}" placeholder="Cantidad" x-model="quantity" >
                <input type="number" step="0.01" name="price-{{product.id}}" placeholder="Precio" x-model="price" value="{{product.price}}">
                <input type="number" step="0.01" name="amount-{{product.id}}" placeholder="Monto" :value="price * quantity" readonly>
            </div>
        {% endfor %}

        <h1>Gastos</h1>

        {% for item in expenses_quantity %}
            <div class="grid">
                <input type="text" name="description-{{item}}-expenses" placeholder="Descripción" required>
                <input type="number" step="0.01" name="amount-{{item}}-expenses" placeholder="Monto" required>
            </div>
        {% endfor %}
        <h1>Créditos</h1>

        {% for item in credits_quantity %}
            <div class="grid">
                <input type="text" name="description-{{item}}-credits" placeholder="Descripción" required>
                <input type="number" step="0.01" name="amount-{{item}}-credits" placeholder="Monto" required>
            </div>
        {% endfor %}

        <h1>Pagos</h1>

        {% for item in payments_quantity %}
            <div class="grid">
                <input type="text" name="description-{{item}}-payments" placeholder="Descripción" required>
                <input type="number" step="0.01" name="amount-{{item}}-payments" placeholder="Monto" required>
            </div>
        {% endfor %}

        <button type="submit">Submit</button>
    </form>



{% endblock %}